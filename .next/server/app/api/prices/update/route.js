(()=>{var e={};e.id=956,e.ids=[956],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},79646:e=>{"use strict";e.exports=require("child_process")},81115:e=>{"use strict";e.exports=require("constants")},55511:e=>{"use strict";e.exports=require("crypto")},19185:e=>{"use strict";e.exports=require("dgram")},14985:e=>{"use strict";e.exports=require("dns")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},91645:e=>{"use strict";e.exports=require("net")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},41204:e=>{"use strict";e.exports=require("string_decoder")},66136:e=>{"use strict";e.exports=require("timers")},34631:e=>{"use strict";e.exports=require("tls")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},4573:e=>{"use strict";e.exports=require("node:buffer")},31421:e=>{"use strict";e.exports=require("node:child_process")},77598:e=>{"use strict";e.exports=require("node:crypto")},78474:e=>{"use strict";e.exports=require("node:events")},73024:e=>{"use strict";e.exports=require("node:fs")},51455:e=>{"use strict";e.exports=require("node:fs/promises")},37067:e=>{"use strict";e.exports=require("node:http")},44708:e=>{"use strict";e.exports=require("node:https")},48161:e=>{"use strict";e.exports=require("node:os")},76760:e=>{"use strict";e.exports=require("node:path")},1708:e=>{"use strict";e.exports=require("node:process")},57075:e=>{"use strict";e.exports=require("node:stream")},73136:e=>{"use strict";e.exports=require("node:url")},57975:e=>{"use strict";e.exports=require("node:util")},38522:e=>{"use strict";e.exports=require("node:zlib")},56726:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>j,routeModule:()=>P,serverHooks:()=>R,workAsyncStorage:()=>S,workUnitAsyncStorage:()=>M});var s={};t.r(s),t.d(s,{POST:()=>I,dynamic:()=>f,preferredRegion:()=>v,revalidate:()=>g,runtime:()=>w});var i=t(42706),o=t(28203),n=t(45994),u=t(99947),a=t.n(u),c=t(79748),p=t.n(c),d=t(33873);let m=t.n(d)().join(process.cwd(),"data","products.json"),l={user:process.env.DB_USER,password:process.env.DB_PASSWORD,server:process.env.DB_SERVER||"",database:process.env.DB_NAME,options:{encrypt:!0,trustServerCertificate:!0}};async function x(){try{let e=await p().readFile(m,"utf-8");return JSON.parse(e)}catch{return[]}}async function q(e){await p().writeFile(m,JSON.stringify(e,null,2))}async function y(){try{return await a().connect(l)}catch(e){throw console.error("Veritabanı bağlantı hatası:",e),e}}async function h(){let e=await y();try{let r=await e.request().query(`
      select ROW_NUMBER() OVER(ORDER BY sm.Name,smc.Name,smi.SubMenuTag,smi.Name,mip.MenuItemPortionId,mip.Id ASC) AS Row#,
        mip.MenuItemPortionId as portion_id,
        mip.Id as prices_id,
        smc.Name as Kategori,
        smi.Name as \xdcr\xfcn,
        mp.Name as Porsiyon,
        mip.Price as Fiyat
      from ScreenMenuItems smi
      join ScreenMenuCategories smc on smc.Id=smi.ScreenMenuCategoryId
      join ScreenMenus sm on sm.Id=smc.ScreenMenuId
      join MenuItems mi on mi.Id=smi.MenuItemId
      join MenuItemPortions mp on mp.MenuItemId=mi.Id
      join MenuItemPrices mip on mip.MenuItemPortionId=mp.Id
      where mip.PriceTag is null
      order by 4,5,6,7,1,2
    `),t=(await x()).map(e=>{let t=r.recordset.find(r=>r["\xdcr\xfcn"].toLowerCase()===e.mssqlProductName?.toLowerCase());return t&&(e.variations?.length?(e.variations=e.variations.map(e=>{let t=r.recordset.find(r=>r.Porsiyon.toLowerCase()===e.name.toLowerCase());return t?{...e,price:t.Fiyat.toString()}:e}),e.variations[0]&&(e.price=e.variations[0].price)):e.price=t.Fiyat.toString()),e});return await q(t),{updatedProducts:t,mssqlProducts:r.recordset}}catch(e){throw console.error("Fiyat g\xfcncelleme hatası:",e),e}finally{await e.close()}}let f="force-dynamic",g=0,w="nodejs",v="auto";async function I(){try{let e=await h();return Response.json({success:!0,message:"Fiyatlar başarıyla g\xfcncellendi",data:{updatedProducts:e.updatedProducts,mssqlProductCount:e.mssqlProducts.length}})}catch(e){return console.error("Fiyat g\xfcncelleme API hatası:",e),Response.json({success:!1,error:"Fiyat g\xfcncelleme işlemi başarısız oldu",details:e instanceof Error?e.message:"Bilinmeyen hata"},{status:500})}}let P=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/prices/update/route",pathname:"/api/prices/update",filename:"route",bundlePath:"app/api/prices/update/route"},resolvedPagePath:"C:\\Users\\PC\\Desktop\\qr men\xfc son hali\\lila\\src\\app\\api\\prices\\update\\route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:S,workUnitAsyncStorage:M,serverHooks:R}=P;function j(){return(0,n.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:M})}},96487:()=>{},78335:()=>{},42706:(e,r,t)=>{"use strict";e.exports=t(44870)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[994,947],()=>t(56726));module.exports=s})();